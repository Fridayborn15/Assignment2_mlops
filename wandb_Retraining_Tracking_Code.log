[Running] python -u "c:\Assignment2_mlops\DriftBased_ModelRetraining_wandbTracking.py"
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: No netrc file found, creating one.
wandb: Appending key for api.wandb.ai to your netrc file: C:\Users\sansharma\_netrc
wandb: Currently logged in as: 2023aa05306 (2023aa05306-bits-pilani) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in c:\Assignment2_mlops\wandb\run-20250318_062234-nwzy7x67
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run drift-detection-run
wandb:  View project at https://wandb.ai/2023aa05306-bits-pilani/fashion-mnist-drift
wandb:  View run at https://wandb.ai/2023aa05306-bits-pilani/fashion-mnist-drift/runs/nwzy7x67
Observed Drift Summary -----  0.12627551020408162
No significant drift detected. Model retraining not required.
wandb: uploading config.yaml
wandb:                                                                                
wandb: 
wandb: Run summary:
wandb: drift_share 0.12628
wandb: 
wandb:  View run drift-detection-run at: https://wandb.ai/2023aa05306-bits-pilani/fashion-mnist-drift/runs/nwzy7x67
wandb:  View project at: https://wandb.ai/2023aa05306-bits-pilani/fashion-mnist-drift
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: .\wandb\run-20250318_062234-nwzy7x67\logs

[Done] exited with code=0 in 84.948 seconds

[Running] python -u "c:\Assignment2_mlops\DriftBased_ModelRetraining_wandbTracking.py"
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: C:\Users\sansharma\_netrc
wandb: Currently logged in as: 2023aa05306 (2023aa05306-bits-pilani) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: creating run
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in c:\Assignment2_mlops\wandb\run-20250318_062503-2vo1mirg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run drift-detection-run
wandb:  View project at https://wandb.ai/2023aa05306-bits-pilani/fashion-mnist-drift
wandb:  View run at https://wandb.ai/2023aa05306-bits-pilani/fashion-mnist-drift/runs/2vo1mirg
Observed Drift Summary -----  0.288265306122449
Significant data drift detected! Retraining the model...
C:\Users\sansharma\AppData\Local\anaconda3\Lib\site-packages\keras\src\layers\reshaping\flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
2025-03-18 06:25:23.852981: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.

[1m  1/313[0m [37m====================[0m [1m4:50[0m 930ms/step - accuracy: 0.1250 - loss: 2.3872
[1m 22/313[0m [32m=[0m[37m===================[0m [1m0s[0m 2ms/step - accuracy: 0.3048 - loss: 1.9354    
[1m 44/313[0m [32m==[0m[37m==================[0m [1m0s[0m 2ms/step - accuracy: 0.3979 - loss: 1.6698
[1m 67/313[0m [32m====[0m[37m================[0m [1m0s[0m 2ms/step - accuracy: 0.4602 - loss: 1.4992
[1m 88/313[0m [32m=====[0m[37m===============[0m [1m0s[0m 2ms/step - accuracy: 0.4979 - loss: 1.3940
[1m110/313[0m [32m=======[0m[37m=============[0m [1m0s[0m 2ms/step - accuracy: 0.5270 - loss: 1.3110
[1m134/313[0m [32m========[0m[37m============[0m [1m0s[0m 2ms/step - accuracy: 0.5527 - loss: 1.2403
[1m154/313[0m [32m=========[0m[37m===========[0m [1m0s[0m 2ms/step - accuracy: 0.5700 - loss: 1.1934
[1m176/313[0m [32m===========[0m[37m=========[0m [1m0s[0m 2ms/step - accuracy: 0.5857 - loss: 1.1502
[1m196/313[0m [32m============[0m[37m========[0m [1m0s[0m 2ms/step - accuracy: 0.5980 - loss: 1.1165
[1m218/313[0m [32m=============[0m[37m=======[0m [1m0s[0m 2ms/step - accuracy: 0.6096 - loss: 1.0847
[1m239/313[0m [32m===============[0m[37m=====[0m [1m0s[0m 2ms/step - accuracy: 0.6193 - loss: 1.0582
[1m260/313[0m [32m================[0m[37m====[0m [1m0s[0m 2ms/step - accuracy: 0.6280 - loss: 1.0346
[1m282/313[0m [32m==================[0m[37m==[0m [1m0s[0m 2ms/step - accuracy: 0.6364 - loss: 1.0123
[1m303/313[0m [32m===================[0m[37m=[0m [1m0s[0m 2ms/step - accuracy: 0.6435 - loss: 0.9931
[1m313/313[0m [32m====================[0m[37m[0m [1m2s[0m 5ms/step - accuracy: 0.6470 - loss: 0.9839 - val_accuracy: 0.8000 - val_loss: 0.5875

[1m  1/313[0m [37m====================[0m [1m7s[0m 22ms/step - accuracy: 0.7500 - loss: 0.5979
[1m 25/313[0m [32m=[0m[37m===================[0m [1m0s[0m 2ms/step - accuracy: 0.7881 - loss: 0.5633 
[1m 50/313[0m [32m===[0m[37m=================[0m [1m0s[0m 2ms/step - accuracy: 0.7961 - loss: 0.5507
[1m 74/313[0m [32m====[0m[37m================[0m [1m0s[0m 2ms/step - accuracy: 0.8015 - loss: 0.5390
[1m 98/313[0m [32m======[0m[37m==============[0m [1m0s[0m 2ms/step - accuracy: 0.8048 - loss: 0.5311
[1m122/313[0m [32m=======[0m[37m=============[0m [1m0s[0m 2ms/step - accuracy: 0.8077 - loss: 0.5246
[1m146/313[0m [32m=========[0m[37m===========[0m [1m0s[0m 2ms/step - accuracy: 0.8100 - loss: 0.5195
[1m171/313[0m [32m==========[0m[37m==========[0m [1m0s[0m 2ms/step - accuracy: 0.8118 - loss: 0.5158
[1m195/313[0m [32m============[0m[37m========[0m [1m0s[0m 2ms/step - accuracy: 0.8129 - loss: 0.5138
[1m217/313[0m [32m=============[0m[37m=======[0m [1m0s[0m 2ms/step - accuracy: 0.8134 - loss: 0.5129
[1m236/313[0m [32m===============[0m[37m=====[0m [1m0s[0m 2ms/step - accuracy: 0.8138 - loss: 0.5124
[1m255/313[0m [32m================[0m[37m====[0m [1m0s[0m 2ms/step - accuracy: 0.8141 - loss: 0.5119
[1m276/313[0m [32m=================[0m[37m===[0m [1m0s[0m 2ms/step - accuracy: 0.8143 - loss: 0.5112
[1m296/313[0m [32m==================[0m[37m==[0m [1m0s[0m 2ms/step - accuracy: 0.8145 - loss: 0.5108
[1m313/313[0m [32m====================[0m[37m[0m [1m1s[0m 4ms/step - accuracy: 0.8147 - loss: 0.5103 - val_accuracy: 0.8405 - val_loss: 0.4745

[1m  1/313[0m [37m====================[0m [1m7s[0m 23ms/step - accuracy: 0.8125 - loss: 0.3852
[1m 25/313[0m [32m=[0m[37m===================[0m [1m0s[0m 2ms/step - accuracy: 0.8423 - loss: 0.4204 
[1m 49/313[0m [32m===[0m[37m=================[0m [1m0s[0m 2ms/step - accuracy: 0.8413 - loss: 0.4332
[1m 73/313[0m [32m====[0m[37m================[0m [1m0s[0m 2ms/step - accuracy: 0.8399 - loss: 0.4374
[1m 97/313[0m [32m======[0m[37m==============[0m [1m0s[0m 2ms/step - accuracy: 0.8390 - loss: 0.4399
[1m120/313[0m [32m=======[0m[37m=============[0m [1m0s[0m 2ms/step - accuracy: 0.8390 - loss: 0.4408
[1m143/313[0m [32m=========[0m[37m===========[0m [1m0s[0m 2ms/step - accuracy: 0.8382 - loss: 0.4438
[1m166/313[0m [32m==========[0m[37m==========[0m [1m0s[0m 2ms/step - accuracy: 0.8377 - loss: 0.4465
[1m188/313[0m [32m============[0m[37m========[0m [1m0s[0m 2ms/step - accuracy: 0.8371 - loss: 0.4485
[1m211/313[0m [32m=============[0m[37m=======[0m [1m0s[0m 2ms/step - accuracy: 0.8365 - loss: 0.4498
[1m233/313[0m [32m==============[0m[37m======[0m [1m0s[0m 2ms/step - accuracy: 0.8360 - loss: 0.4515
[1m254/313[0m [32m================[0m[37m====[0m [1m0s[0m 2ms/step - accuracy: 0.8359 - loss: 0.4524
[1m276/313[0m [32m=================[0m[37m===[0m [1m0s[0m 2ms/step - accuracy: 0.8358 - loss: 0.4532
[1m299/313[0m [32m===================[0m[37m=[0m [1m0s[0m 2ms/step - accuracy: 0.8358 - loss: 0.4536
[1m313/313[0m [32m====================[0m[37m[0m [1m1s[0m 4ms/step - accuracy: 0.8359 - loss: 0.4537 - val_accuracy: 0.8212 - val_loss: 0.4810

[1m  1/313[0m [37m====================[0m [1m6s[0m 20ms/step - accuracy: 0.9062 - loss: 0.5247
[1m 25/313[0m [32m=[0m[37m===================[0m [1m0s[0m 2ms/step - accuracy: 0.8638 - loss: 0.4086 
[1m 50/313[0m [32m===[0m[37m=================[0m [1m0s[0m 2ms/step - accuracy: 0.8607 - loss: 0.4086
[1m 71/313[0m [32m====[0m[37m================[0m [1m0s[0m 2ms/step - accuracy: 0.8592 - loss: 0.4106
[1m 92/313[0m [32m=====[0m[37m===============[0m [1m0s[0m 2ms/step - accuracy: 0.8575 - loss: 0.4152
[1m111/313[0m [32m=======[0m[37m=============[0m [1m0s[0m 2ms/step - accuracy: 0.8561 - loss: 0.4181
[1m134/313[0m [32m========[0m[37m============[0m [1m0s[0m 2ms/step - accuracy: 0.8552 - loss: 0.4197
[1m158/313[0m [32m==========[0m[37m==========[0m [1m0s[0m 2ms/step - accuracy: 0.8547 - loss: 0.4197
[1m181/313[0m [32m===========[0m[37m=========[0m [1m0s[0m 2ms/step - accuracy: 0.8545 - loss: 0.4196
[1m206/313[0m [32m=============[0m[37m=======[0m [1m0s[0m 2ms/step - accuracy: 0.8543 - loss: 0.4192
[1m229/313[0m [32m==============[0m[37m======[0m [1m0s[0m 2ms/step - accuracy: 0.8543 - loss: 0.4184
[1m253/313[0m [32m================[0m[37m====[0m [1m0s[0m 2ms/step - accuracy: 0.8541 - loss: 0.4180
[1m276/313[0m [32m=================[0m[37m===[0m [1m0s[0m 2ms/step - accuracy: 0.8541 - loss: 0.4175
[1m298/313[0m [32m===================[0m[37m=[0m [1m0s[0m 2ms/step - accuracy: 0.8540 - loss: 0.4174
[1m313/313[0m [32m====================[0m[37m[0m [1m1s[0m 4ms/step - accuracy: 0.8538 - loss: 0.4176 - val_accuracy: 0.8429 - val_loss: 0.4303

[1m  1/313[0m [37m====================[0m [1m6s[0m 22ms/step - accuracy: 0.8750 - loss: 0.4256
[1m 24/313[0m [32m=[0m[37m===================[0m [1m0s[0m 2ms/step - accuracy: 0.8257 - loss: 0.4376 
[1m 48/313[0m [32m===[0m[37m=================[0m [1m0s[0m 2ms/step - accuracy: 0.8422 - loss: 0.4129
[1m 70/313[0m [32m====[0m[37m================[0m [1m0s[0m 2ms/step - accuracy: 0.8487 - loss: 0.4050
[1m 93/313[0m [32m=====[0m[37m===============[0m [1m0s[0m 2ms/step - accuracy: 0.8522 - loss: 0.4001
[1m116/313[0m [32m=======[0m[37m=============[0m [1m0s[0m 2ms/step - accuracy: 0.8542 - loss: 0.3969
[1m139/313[0m [32m========[0m[37m============[0m [1m0s[0m 2ms/step - accuracy: 0.8556 - loss: 0.3951
[1m162/313[0m [32m==========[0m[37m==========[0m [1m0s[0m 2ms/step - accuracy: 0.8566 - loss: 0.3942
[1m184/313[0m [32m===========[0m[37m=========[0m [1m0s[0m 2ms/step - accuracy: 0.8573 - loss: 0.3935
[1m190/313[0m [32m============[0m[37m========[0m [1m0s[0m 2ms/step - accuracy: 0.8575 - loss: 0.3934
[1m205/313[0m [32m=============[0m[37m=======[0m [1m0s[0m 2ms/step - accuracy: 0.8579 - loss: 0.3932
[1m228/313[0m [32m==============[0m[37m======[0m [1m0s[0m 2ms/step - accuracy: 0.8582 - loss: 0.3932
[1m249/313[0m [32m===============[0m[37m=====[0m [1m0s[0m 2ms/step - accuracy: 0.8584 - loss: 0.3934
[1m272/313[0m [32m=================[0m[37m===[0m [1m0s[0m 2ms/step - accuracy: 0.8585 - loss: 0.3937
[1m293/313[0m [32m==================[0m[37m==[0m [1m0s[0m 2ms/step - accuracy: 0.8585 - loss: 0.3939
[1m313/313[0m [32m====================[0m[37m[0m [1m1s[0m 4ms/step - accuracy: 0.8586 - loss: 0.3940 - val_accuracy: 0.8574 - val_loss: 0.3985
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Model retrained and saved as 'fashion_mnist_updated_model.h5'
wandb: uploading fashion_mnist_updated_model.h5; uploading config.yaml
wandb: uploading fashion_mnist_updated_model.h5
wandb:                                                                                
wandb: 
wandb: Run summary:
wandb:     accuracy 0.8597
wandb:  drift_share 0.28827
wandb:        epoch 5
wandb:         loss 0.39407
wandb: val_accuracy 0.8574
wandb:     val_loss 0.39855
wandb: 
wandb:  View run drift-detection-run at: https://wandb.ai/2023aa05306-bits-pilani/fashion-mnist-drift/runs/2vo1mirg
wandb:  View project at: https://wandb.ai/2023aa05306-bits-pilani/fashion-mnist-drift
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 1 other file(s)
wandb: Find logs at: .\wandb\run-20250318_062503-2vo1mirg\logs

[Done] exited with code=0 in 51.338 seconds

